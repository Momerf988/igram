{"ast":null,"code":"import React,{useState,useEffect,useContext}from'react';import{AuthContext}from'../context/AuthContext';import axios from'axios';import API_URL from'../config/api';import PostCard from'../components/PostCard';import CreatePostModal from'../components/CreatePostModal';import'./Home.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Home=()=>{const{user,logout}=useContext(AuthContext);const[posts,setPosts]=useState([]);const[filteredPosts,setFilteredPosts]=useState([]);const[loading,setLoading]=useState(true);const[showCreateModal,setShowCreateModal]=useState(false);const[error,setError]=useState('');const[searchQuery,setSearchQuery]=useState('');useEffect(()=>{fetchPosts();},[]);useEffect(()=>{if(searchQuery.trim()){const query=searchQuery.toLowerCase();const filtered=posts.filter(post=>{var _post$title,_post$caption,_post$location;const titleMatch=(_post$title=post.title)===null||_post$title===void 0?void 0:_post$title.toLowerCase().includes(query);const captionMatch=(_post$caption=post.caption)===null||_post$caption===void 0?void 0:_post$caption.toLowerCase().includes(query);const locationMatch=(_post$location=post.location)===null||_post$location===void 0?void 0:_post$location.toLowerCase().includes(query);return titleMatch||captionMatch||locationMatch;});setFilteredPosts(filtered);}else{setFilteredPosts(posts);}},[searchQuery,posts]);const fetchPosts=async()=>{try{const response=await axios.get(\"\".concat(API_URL,\"/posts\"));setPosts(response.data);setFilteredPosts(response.data);}catch(err){setError('Failed to load posts');}finally{setLoading(false);}};const handlePostCreated=newPost=>{console.log('Post created - received from backend:',{id:newPost._id,title:newPost.title,location:newPost.location,caption:newPost.caption,people:newPost.people});setPosts([newPost,...posts]);setShowCreateModal(false);};const handlePostDeleted=postId=>{setPosts(posts.filter(p=>p._id!==postId));};const handleLikeToggle=async postId=>{try{await axios.post(\"\".concat(API_URL,\"/likes/\").concat(postId));fetchPosts();}catch(err){console.error('Failed to toggle like:',err);}};const handleCommentAdded=()=>{fetchPosts();};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:\"Loading posts...\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"home-container\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"home-header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"igram\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"header-actions\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"search-container\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"search-input\",placeholder:\"Search by title, caption, or location...\",value:searchQuery,onChange:e=>setSearchQuery(e.target.value)})}),/*#__PURE__*/_jsxs(\"span\",{className:\"user-info\",children:[user.name||user.username,\" (Creator)\"]}),/*#__PURE__*/_jsx(\"button\",{className:\"create-post-btn\",onClick:()=>setShowCreateModal(true),children:\"+ Create Post\"}),/*#__PURE__*/_jsx(\"button\",{className:\"logout-btn\",onClick:()=>{logout();window.location.href='/';},children:\"Logout\"})]})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:error}),/*#__PURE__*/_jsx(\"div\",{className:\"posts-container\",children:filteredPosts.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"no-posts\",children:searchQuery?'No posts found matching your search.':'No posts yet. Be the first to create one!'}):filteredPosts.map(post=>/*#__PURE__*/_jsx(PostCard,{post:post,currentUser:user,onPostDeleted:handlePostDeleted,onLikeToggle:handleLikeToggle,onCommentAdded:handleCommentAdded},post._id))}),showCreateModal&&/*#__PURE__*/_jsx(CreatePostModal,{onClose:()=>setShowCreateModal(false),onPostCreated:handlePostCreated})]});};export default Home;","map":{"version":3,"names":["React","useState","useEffect","useContext","AuthContext","axios","API_URL","PostCard","CreatePostModal","jsx","_jsx","jsxs","_jsxs","Home","user","logout","posts","setPosts","filteredPosts","setFilteredPosts","loading","setLoading","showCreateModal","setShowCreateModal","error","setError","searchQuery","setSearchQuery","fetchPosts","trim","query","toLowerCase","filtered","filter","post","_post$title","_post$caption","_post$location","titleMatch","title","includes","captionMatch","caption","locationMatch","location","response","get","concat","data","err","handlePostCreated","newPost","console","log","id","_id","people","handlePostDeleted","postId","p","handleLikeToggle","handleCommentAdded","className","children","type","placeholder","value","onChange","e","target","name","username","onClick","window","href","length","map","currentUser","onPostDeleted","onLikeToggle","onCommentAdded","onClose","onPostCreated"],"sources":["C:/Users/Omer/mini-instagram-app/frontend/src/pages/Home.js"],"sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\r\nimport { AuthContext } from '../context/AuthContext';\r\nimport axios from 'axios';\r\nimport API_URL from '../config/api';\r\nimport PostCard from '../components/PostCard';\r\nimport CreatePostModal from '../components/CreatePostModal';\r\nimport './Home.css';\r\n\r\nconst Home = () => {\r\n  const { user, logout } = useContext(AuthContext);\r\n  const [posts, setPosts] = useState([]);\r\n  const [filteredPosts, setFilteredPosts] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [showCreateModal, setShowCreateModal] = useState(false);\r\n  const [error, setError] = useState('');\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n\r\n  useEffect(() => {\r\n    fetchPosts();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (searchQuery.trim()) {\r\n      const query = searchQuery.toLowerCase();\r\n      const filtered = posts.filter(post => {\r\n        const titleMatch = post.title?.toLowerCase().includes(query);\r\n        const captionMatch = post.caption?.toLowerCase().includes(query);\r\n        const locationMatch = post.location?.toLowerCase().includes(query);\r\n        return titleMatch || captionMatch || locationMatch;\r\n      });\r\n      setFilteredPosts(filtered);\r\n    } else {\r\n      setFilteredPosts(posts);\r\n    }\r\n  }, [searchQuery, posts]);\r\n\r\n  const fetchPosts = async () => {\r\n    try {\r\n      const response = await axios.get(`${API_URL}/posts`);\r\n      setPosts(response.data);\r\n      setFilteredPosts(response.data);\r\n    } catch (err) {\r\n      setError('Failed to load posts');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handlePostCreated = (newPost) => {\r\n    console.log('Post created - received from backend:', {\r\n      id: newPost._id,\r\n      title: newPost.title,\r\n      location: newPost.location,\r\n      caption: newPost.caption,\r\n      people: newPost.people\r\n    });\r\n    setPosts([newPost, ...posts]);\r\n    setShowCreateModal(false);\r\n  };\r\n\r\n  const handlePostDeleted = (postId) => {\r\n    setPosts(posts.filter(p => p._id !== postId));\r\n  };\r\n\r\n  const handleLikeToggle = async (postId) => {\r\n    try {\r\n      await axios.post(`${API_URL}/likes/${postId}`);\r\n      fetchPosts();\r\n    } catch (err) {\r\n      console.error('Failed to toggle like:', err);\r\n    }\r\n  };\r\n\r\n  const handleCommentAdded = () => {\r\n    fetchPosts();\r\n  };\r\n\r\n  if (loading) {\r\n    return <div className=\"loading\">Loading posts...</div>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"home-container\">\r\n      <header className=\"home-header\">\r\n        <h1>igram</h1>\r\n        <div className=\"header-actions\">\r\n          <div className=\"search-container\">\r\n            <input\r\n              type=\"text\"\r\n              className=\"search-input\"\r\n              placeholder=\"Search by title, caption, or location...\"\r\n              value={searchQuery}\r\n              onChange={(e) => setSearchQuery(e.target.value)}\r\n            />\r\n          </div>\r\n          <span className=\"user-info\">\r\n            {user.name || user.username} (Creator)\r\n          </span>\r\n          <button\r\n            className=\"create-post-btn\"\r\n            onClick={() => setShowCreateModal(true)}\r\n          >\r\n            + Create Post\r\n          </button>\r\n          <button className=\"logout-btn\" onClick={() => {\r\n            logout();\r\n            window.location.href = '/';\r\n          }}>\r\n            Logout\r\n          </button>\r\n        </div>\r\n      </header>\r\n\r\n      {error && <div className=\"error-message\">{error}</div>}\r\n\r\n      <div className=\"posts-container\">\r\n        {filteredPosts.length === 0 ? (\r\n          <div className=\"no-posts\">\r\n            {searchQuery ? 'No posts found matching your search.' : 'No posts yet. Be the first to create one!'}\r\n          </div>\r\n        ) : (\r\n          filteredPosts.map(post => (\r\n            <PostCard\r\n              key={post._id}\r\n              post={post}\r\n              currentUser={user}\r\n              onPostDeleted={handlePostDeleted}\r\n              onLikeToggle={handleLikeToggle}\r\n              onCommentAdded={handleCommentAdded}\r\n            />\r\n          ))\r\n        )}\r\n      </div>\r\n\r\n      {showCreateModal && (\r\n        <CreatePostModal\r\n          onClose={() => setShowCreateModal(false)}\r\n          onPostCreated={handlePostCreated}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Home;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}